# 需求规格说明

## 用户需求
一个猜数字游戏，1-100之间随机生成数字，用户输入猜测，程序提示太大或太小，猜对后显示用了几次

## 技术规格
# PHASE 1: 猜数字游戏 - 需求分析

## 1. 核心功能与特性

### 1.1 基本功能
| 功能 | 描述 |
|------|------|
| 随机数生成 | 在1-100范围内随机生成一个目标整数 |
| 用户输入 | 接收用户输入的猜测数字 |
| 反馈机制 | 对每次猜测返回"太大"、"太小"或"正确"提示 |
| 计数器 | 记录并显示用户猜测次数 |
| 结束判定 | 正确猜测后结束游戏，可选择重新开始 |

### 1.2 扩展功能
- **难度模式**: 简单(1-100)、中等(1-1000)、困难(1-10000)
- **历史记录**: 显示本次游戏的所有猜测历史
- **最佳记录**: 保存历史最佳(最少次数)记录
- **提示功能**: 在多次失败后提供区间提示

---

## 2. 技术要求与约束

### 2.1 环境要求
```
Python版本: >= 3.6
无需外部依赖库 (仅使用标准库)
```

### 2.2 功能约束
- 随机数必须包含1和100边界值
- 输入验证必须处理非数字、浮点数、空输入等情况
- 计数器必须准确记录有效猜测次数
- 程序必须在合理时间内响应用户输入

---

## 3. 数据结构与算法

### 3.1 核心数据结构
```python
class GuessNumberGame:
    target_number: int      # 目标数字
    guess_count: int        # 猜测次数
    guess_history: List[int]  # 猜测历史
    min_range: int          # 范围最小值
    max_range: int          # 范围最大值
    best_record: Optional[int]  # 历史最佳记录
```

### 3.2 算法流程
```
┌─────────────────┐
│   游戏初始化    │
└────────┬────────┘
         ▼
┌─────────────────┐
│ 生成随机目标数  │
└────────┬────────┘
         ▼
┌─────────────────┐
│  等待用户输入   │
└────────┬────────┘
         ▼
    ┌────┴────┐
    │ 输入验证 │
    └────┬────┘
         ▼
    ┌────┴────┐
    │ 猜对了吗?│
    └────┬────┘
       ┌─┴─┐
      是  否
       │   │
       ▼   ▼
   ┌────┐ ┌─────┐
   │结束│ │反馈 │
   └────┘ └──┬──┘
             │
             ▼
        ┌────┴────┐
        │计数+1   │
        └────┬────┘
             ▼
        返回输入
```

### 3.3 二分查找优化（可选策略提示）
- 二分查找策略可在最坏情况下保证 `log₂(100) ≈ 7` 次内猜中
- 可作为AI模式或向用户展示"最优策略"

---

## 4. 用户界面与交互模式

### 4.1 控制台交互设计
```
╔══════════════════════════════════════╗
║       🎯 猜数字游戏 (1-100)          ║
╠══════════════════════════════════════╣
║  目标数字已生成！开始猜测吧～         ║
║                                      ║
║  请输入你的猜测 (1-100): ____        ║
║  > [用户输入]                         ║
║                                      ║
║  📈 太大了！再试试吧                  ║
║  猜测历史: [2, 45, 67]               ║
║                                      ║
║  ✅ 恭喜！你在 5 次内猜中了！         ║
║  最佳记录: 3 次                       ║
║                                      ║
║  [1] 再来一局  [2] 退出  [3] 更改难度 ║
╚══════════════════════════════════════╝
```

### 4.2 输入提示层级
1. **首次提示**: "请输入你的猜测 (1-100):"
2. **无效输入后**: "⚠️ 请输入有效数字！"
3. **超范围输入**: "⚠️ 数字必须在 1 到 100 之间！"
4. **范围外猜测**: "📈 提示: 你猜的数字超出有效范围"
5. **猜测反馈**: "📈 太大了！" / "📉太小了！" / "✅ 正确！"

---

## 5. 错误处理与边缘情况

### 5.1 输入验证矩阵
| 输入类型 | 处理方式 | 用户反馈 |
|---------|---------|---------|
| 空字符串 | 重新提示 | "输入不能为空" |
| 非数字字符 | 重新提示 | "请输入有效数字" |
| 浮点数(3.14) | 取整或拒绝 | "请输入整数" |
| 超范围(<1) | 重新提示 | "数字不能小于1" |
| 超范围(>100) | 重新提示 | "数字不能大于100" |
| 重复猜测 | 警告但不计数 | "你已经猜过这个数字" |
| 特殊字符 | 重新提示 | "包含非法字符" |

### 5.2 系统异常处理
```python
try:
    # 随机数生成
    target = random.randint(1, 100)
except Exception:
    # 记录日志，返回错误状态
    
try:
    # 用户输入
    guess = int(input())
except EOFError:
    # 优雅退出
    return
except ValueError:
    # 提示重新输入
```

### 5.3 边界情况
- ✅ 用户首次输入即为正确答案
- ✅ 用户恰好在第7次(二分查找最优次数)猜中
- ✅ 用户连续100次都猜错(理论上不可能)
- ✅ 程序在极端频繁输入下的响应

---

## 6. 性能考虑

### 6.1 时间复杂度
| 操作 | 时间复杂度 | 说明 |
|------|-----------|------|
| 随机数生成 | O(1) | 使用标准库 |
| 输入验证 | O(1) | 字符串操作 |
| 猜测比较 | O(1) | 整数比较 |
| 历史记录 | O(1) | 列表追加 |

### 6.2 空间复杂度
- **O(1)**: 基础游戏状态
- **O(n)**: 存储n次猜测历史（n最大为100）
- **O(1)**: 最佳记录存储

### 6.3 优化策略
1. **输入缓冲**: 使用`input().strip()`避免空白字符问题
2. **快速失败**: 尽早验证输入范围，减少无效处理
3. **惰性求值**: 仅在需要时格式化输出

---

## 7. 后续阶段预览

完成需求分析后，**PHASE 2** 将包含：
- 完整的类设计和代码架构
- 核心算法实现细节
- 单元测试用例设计
- 完整代码文件结构

---

## 📋 技术规范确认

**请确认以下规范是否满足您的需求:**

1. ✅ 基础猜数字功能 (1-100)
2. ✅ 实时反馈机制
3. ✅ 猜测次数统计
4. ✅ 输入错误处理
5. ⬜ 图形界面需求?
6. ⬜ 其他扩展功能?

请确认规范无误后，我将进入 **PHASE 2: 系统设计与代码实现**。
